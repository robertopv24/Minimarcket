<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menú Digital - Pizzas y Pastelería J&Y</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define la fuente Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap');

        /* Estilos base */
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        /* Contenedor principal del carrusel */
        #carousel-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* Estilos de las diapositivas (imágenes) */
        .slide {
            width: 100%;
            height: 100%;
            background-size: 100% 100%; /* Fuerza el ajuste completo (puede haber distorsión) */
            background-position: center;
            background-repeat: no-repeat;
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        .slide.active {
            display: block;
            opacity: 1;
        }

        /* Estilos específicos para el video */
        .slide video {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Asegura que el video cubra el área sin barras negras */
        }

        /* Estilo para el prompt de pantalla completa */
        #fullscreen-prompt {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 2em;
            cursor: pointer;
            z-index: 100;
        }

        /* Estilo para la caja de sugerencia del chef */
        #chef-suggestion {
            position: absolute;
            bottom: 3vh; /* Ajuste responsivo */
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 650px;
            padding: 15px 25px;
            background-color: rgba(0, 0, 0, 0.4); /* Fondo semi-transparente */
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.6);
            text-align: center;
            font-weight: 700;
            z-index: 10;
            border: 4px solid #f9a825; /* Borde amarillo brillante */
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none; /* Ignora clics */
        }

        #chef-suggestion.visible {
            opacity: 1;
        }

        #chef-suggestion-text {
            font-style: italic;
            display: block;
            margin-top: 5px;
            font-size: 1.2em;
            color: #ffeb3b; /* Color amarillo más claro para el mensaje */
        }

        #chef-suggestion-title {
             font-size: 1.3em;
             color: #f9a825; /* Color amarillo-naranja para el título */
        }
    </style>
</head>
<body>

    <!-- Prompt para iniciar la pantalla completa -->
    <div id="fullscreen-prompt">
        <p>Toca o haz clic para iniciar la presentación en pantalla completa.</p>
        <p class="text-lg mt-4 text-gray-400">(El carrusel iniciará automáticamente en modo normal si no hay interacción)</p>
    </div>

    <!-- Contenedor principal del carrusel -->
    <div id="carousel-container">

        <!-- Diapositiva 1: Imagen inicial (0.jpg) -->
        <div class="slide" style="background-image: url('0.png');" data-slide-name="Portada Inicial"></div>

        <!-- Diapositiva 2: Video de Introducción (1.mp4) -->
        <div class="slide" data-slide-name="Video Intro">
            <video id="intro-video" muted playsinline preload="auto">
                <!-- Usar la ruta relativa del archivo subido -->
                <source src="1.mp4" type="video/mp4">
                Tu navegador no soporta el elemento de video.
            </video>
        </div>

        <!-- Diapositivas de Menú (1.jpg a 11.jpg) -->
        <div class="slide" style="background-image: url('1.png');" data-slide-name="Oferta 10 Perros"></div>
        <div class="slide" style="background-image: url('2.png');" data-slide-name="Oferta 5 Perros"></div>
        <div class="slide" style="background-image: url('3.png');" data-slide-name="Combo #1"></div>
        <div class="slide" style="background-image: url('4.png');" data-slide-name="Combo #2"></div>
        <div class="slide" style="background-image: url('5.png');" data-slide-name="Combo #3"></div>
        <div class="slide" style="background-image: url('6.png');" data-slide-name="Combo #4"></div>
        <div class="slide" style="background-image: url('7.png');" data-slide-name="Combo #5"></div>
        <div class="slide" style="background-image: url('8.png');" data-slide-name="Combo #6"></div>
        <div class="slide" style="background-image: url('9.png');" data-slide-name="Combo Familiar Grande"></div>
        <div class="slide" style="background-image: url('10.png');" data-slide-name="Calzón Individual"></div>

    </div>

    <!-- Caja de sugerencia (Flota sobre todas las diapositivas) -->
    <div id="chef-suggestion">
        <span id="chef-suggestion-title">✨ Sugerencia del Chef:</span>
        <span id="chef-suggestion-text"></span>
    </div>

    <script type="module">
        // --- Duraciones ---
        const imageDuration = 12000; // 8 segundos para imágenes
        let videoDuration = 7000;   // Duración predeterminada (se ajustará con el evento 'loadedmetadata')

        // --- Configuración del Carrusel ---
        const slides = document.querySelectorAll('.slide');
        const introVideo = document.getElementById('intro-video');
        const suggestionBox = document.getElementById('chef-suggestion');
        const suggestionText = document.getElementById('chef-suggestion-text');
        const fullscreenPrompt = document.getElementById('fullscreen-prompt');

        let currentSlideIndex = 0;
        let carruselInterval;

        // 75% de probabilidad de mostrar la sugerencia en slides de menú
        const suggestionProbability = 0.40;

        // Sugerencias de respaldo (Fallback)
        const predefinedSuggestions = [
            "¡Añade unos tequeños extras para que nadie se quede con las ganas!",
            "¡Unas barquillas son el postre perfecto para terminar la fiesta!",
            "¿Prefieres algo más? ¡Prueba el Calzón individual, por solo $4!",
            "¡No te quedes sin el postre! Pídelo ahora, Es el complemento ideal.",
            "¡Doble refresco para la sobremesa! Pídelo ahora.",
        ];

        // --- Funciones del Carrusel ---

        // Función para cambiar de diapositiva
        function showSlide(index) {
            // Oculta todas las diapositivas
            slides.forEach(slide => {
                slide.classList.remove('active');
            });

            // Muestra la diapositiva actual
            slides[index].classList.add('active');

            // 1. Lógica de reproducción de video (Diapositiva 2, índice 1)
            if (index === 1 && introVideo) {
                // Asegura que el video esté silenciado para autoplay
                introVideo.muted = true;
                introVideo.currentTime = 0; // Reinicia el video
                introVideo.play().catch(e => console.log("Video autoplay blocked, but starting carrusel."));
            } else if (introVideo) {
                introVideo.pause();
            }

            // 2. Lógica de Sugerencia Predefinida (Diapositivas de menú: índice > 1)
            if (index > 1) {
                // Oculta la sugerencia por defecto
                suggestionBox.classList.remove('visible');

                // Aplica probabilidad de mostrar la sugerencia (75%)
                if (Math.random() < suggestionProbability) {
                    const fallbackIndex = Math.floor(Math.random() * predefinedSuggestions.length);
                    suggestionText.textContent = predefinedSuggestions[fallbackIndex];
                    suggestionBox.classList.add('visible');
                }
            } else {
                // Oculta la sugerencia en la portada y el video
                suggestionBox.classList.remove('visible');
            }
        }

        // Función para avanzar al siguiente slide
        function nextSlide() {
            currentSlideIndex = (currentSlideIndex + 1) % slides.length;
            showSlide(currentSlideIndex);

            // Ajusta el intervalo basado en el tipo de slide
            const duration = currentSlideIndex === 1 ? videoDuration : imageDuration;

            clearInterval(carruselInterval);
            carruselInterval = setInterval(nextSlide, duration);
        }

        // Inicia la rotación del carrusel
        function startCarousel() {
            // Asegura que el carrusel solo se inicie una vez
            if (carruselInterval) return;

            showSlide(currentSlideIndex);
            // El primer intervalo será la duración de la primera diapositiva (imagenDuration)
            carruselInterval = setInterval(nextSlide, imageDuration);
        }

        // --- Funciones de Pantalla Completa ---

        function openFullscreen() {
            const elem = document.documentElement;
            try {
                if (elem.requestFullscreen) {
                    elem.requestFullscreen();
                } else if (elem.webkitRequestFullscreen) { /* Safari */
                    elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) { /* IE11 */
                    elem.msRequestFullscreen();
                }
            } catch (e) {
                // Silencia el error "Disallowed by permissions policy"
                console.error("No se pudo iniciar la pantalla completa (posiblemente bloqueado por el navegador/entorno).", e);
            }
        }

        // Manejador del evento de clic para iniciar la pantalla completa y ocultar el prompt
        function handleFullscreenActivation() {
            openFullscreen();
            fullscreenPrompt.style.display = 'none';
            // Una vez que el usuario interactúa, se remueve el listener de inicio (para evitar múltiples inicios de FS)
            document.body.removeEventListener('click', handleFullscreenActivation);
            document.body.removeEventListener('touchstart', handleFullscreenActivation);
        }


        // --- Inicialización ---

        // 1. Ajuste de duración del video
        if (introVideo) {
            // Este evento garantiza que tengamos la duración correcta del video antes de usarla
            introVideo.addEventListener('loadedmetadata', () => {
                videoDuration = introVideo.duration * 1000;
                console.log(`Duración del video ajustada a: ${videoDuration}ms`);
            });
        }

        // 2. Inicia el Carrusel inmediatamente al cargar (para vista previa)
        document.addEventListener('DOMContentLoaded', () => {
            startCarousel();
        });

        // 3. Configura el listener para la pantalla completa
        document.body.addEventListener('click', handleFullscreenActivation);
        document.body.addEventListener('touchstart', handleFullscreenActivation);

    </script>
</body>
</html>
